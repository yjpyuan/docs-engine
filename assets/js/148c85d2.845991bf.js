"use strict";(globalThis.webpackChunkw3bank_knowledge_wiki=globalThis.webpackChunkw3bank_knowledge_wiki||[]).push([[7504],{1206(e,n,s){s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>u,frontMatter:()=>a,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"L0-enterprise/standards/python/python-review","title":"Python Code Review Guide","description":"Python \u4ee3\u7801\u5ba1\u67e5\u6307\u5357\uff0c\u8986\u76d6\u7c7b\u578b\u6ce8\u89e3\u3001async/await\u3001\u6d4b\u8bd5\u3001\u5f02\u5e38\u5904\u7406\u3001\u6027\u80fd\u4f18\u5316\u7b49\u6838\u5fc3\u4e3b\u9898\u3002","source":"@site/docs/L0-enterprise/standards/python/python-review.md","sourceDirName":"L0-enterprise/standards/python","slug":"/L0-enterprise/standards/python/python-review","permalink":"/docs-engine/docs/L0-enterprise/standards/python/python-review","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/L0-enterprise/standards/python/python-review.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"python-pro","permalink":"/docs-engine/docs/L0-enterprise/standards/python/python-pro"},"next":{"title":"Python \u9879\u76ee\u811a\u624b\u67b6","permalink":"/docs-engine/docs/L0-enterprise/standards/python/python-scaffold-cn"}}');var r=s(4848),i=s(8453);const a={},l="Python Code Review Guide",c={},o=[{value:"\u76ee\u5f55",id:"\u76ee\u5f55",level:2},{value:"\u7c7b\u578b\u6ce8\u89e3",id:"\u7c7b\u578b\u6ce8\u89e3",level:2},{value:"\u57fa\u7840\u7c7b\u578b\u6ce8\u89e3",id:"\u57fa\u7840\u7c7b\u578b\u6ce8\u89e3",level:3},{value:"\u5bb9\u5668\u7c7b\u578b\u6ce8\u89e3",id:"\u5bb9\u5668\u7c7b\u578b\u6ce8\u89e3",level:3},{value:"\u6cdb\u578b\u4e0e TypeVar",id:"\u6cdb\u578b\u4e0e-typevar",level:3},{value:"Callable \u4e0e\u56de\u8c03\u51fd\u6570",id:"callable-\u4e0e\u56de\u8c03\u51fd\u6570",level:3},{value:"TypedDict \u4e0e\u7ed3\u6784\u5316\u6570\u636e",id:"typeddict-\u4e0e\u7ed3\u6784\u5316\u6570\u636e",level:3},{value:"Protocol \u4e0e\u7ed3\u6784\u5316\u5b50\u7c7b\u578b",id:"protocol-\u4e0e\u7ed3\u6784\u5316\u5b50\u7c7b\u578b",level:3},{value:"\u5f02\u6b65\u7f16\u7a0b",id:"\u5f02\u6b65\u7f16\u7a0b",level:2},{value:"async/await \u57fa\u7840",id:"asyncawait-\u57fa\u7840",level:3},{value:"\u5f02\u6b65\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668",id:"\u5f02\u6b65\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668",level:3},{value:"\u5f02\u6b65\u8fed\u4ee3\u5668",id:"\u5f02\u6b65\u8fed\u4ee3\u5668",level:3},{value:"\u4efb\u52a1\u7ba1\u7406\u4e0e\u53d6\u6d88",id:"\u4efb\u52a1\u7ba1\u7406\u4e0e\u53d6\u6d88",level:3},{value:"\u540c\u6b65\u4e0e\u5f02\u6b65\u6df7\u5408",id:"\u540c\u6b65\u4e0e\u5f02\u6b65\u6df7\u5408",level:3},{value:"\u4fe1\u53f7\u91cf\u4e0e\u9650\u6d41",id:"\u4fe1\u53f7\u91cf\u4e0e\u9650\u6d41",level:3},{value:"\u5f02\u5e38\u5904\u7406",id:"\u5f02\u5e38\u5904\u7406",level:2},{value:"\u5f02\u5e38\u6355\u83b7\u6700\u4f73\u5b9e\u8df5",id:"\u5f02\u5e38\u6355\u83b7\u6700\u4f73\u5b9e\u8df5",level:3},{value:"\u5f02\u5e38\u94fe",id:"\u5f02\u5e38\u94fe",level:3},{value:"\u81ea\u5b9a\u4e49\u5f02\u5e38",id:"\u81ea\u5b9a\u4e49\u5f02\u5e38",level:3},{value:"\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u4e2d\u7684\u5f02\u5e38",id:"\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u4e2d\u7684\u5f02\u5e38",level:3},{value:"\u5e38\u89c1\u9677\u9631",id:"\u5e38\u89c1\u9677\u9631",level:2},{value:"\u53ef\u53d8\u9ed8\u8ba4\u53c2\u6570",id:"\u53ef\u53d8\u9ed8\u8ba4\u53c2\u6570",level:3},{value:"\u53ef\u53d8\u7c7b\u5c5e\u6027",id:"\u53ef\u53d8\u7c7b\u5c5e\u6027",level:3},{value:"\u5faa\u73af\u4e2d\u7684\u95ed\u5305",id:"\u5faa\u73af\u4e2d\u7684\u95ed\u5305",level:3},{value:"is vs ==",id:"is-vs-",level:3},{value:"\u5b57\u7b26\u4e32\u62fc\u63a5\u6027\u80fd",id:"\u5b57\u7b26\u4e32\u62fc\u63a5\u6027\u80fd",level:3},{value:"\u6d4b\u8bd5\u6700\u4f73\u5b9e\u8df5",id:"\u6d4b\u8bd5\u6700\u4f73\u5b9e\u8df5",level:2},{value:"pytest \u57fa\u7840",id:"pytest-\u57fa\u7840",level:3},{value:"Fixtures",id:"fixtures",level:3},{value:"Mock \u4e0e Patch",id:"mock-\u4e0e-patch",level:3},{value:"\u6d4b\u8bd5\u7ec4\u7ec7",id:"\u6d4b\u8bd5\u7ec4\u7ec7",level:3},{value:"\u8986\u76d6\u7387\u4e0e\u8d28\u91cf",id:"\u8986\u76d6\u7387\u4e0e\u8d28\u91cf",level:3},{value:"\u6027\u80fd\u4f18\u5316",id:"\u6027\u80fd\u4f18\u5316",level:2},{value:"\u6570\u636e\u7ed3\u6784\u9009\u62e9",id:"\u6570\u636e\u7ed3\u6784\u9009\u62e9",level:3},{value:"\u751f\u6210\u5668\u4e0e\u8fed\u4ee3\u5668",id:"\u751f\u6210\u5668\u4e0e\u8fed\u4ee3\u5668",level:3},{value:"\u7f13\u5b58",id:"\u7f13\u5b58",level:3},{value:"\u5e76\u884c\u5904\u7406",id:"\u5e76\u884c\u5904\u7406",level:3},{value:"\u4ee3\u7801\u98ce\u683c",id:"\u4ee3\u7801\u98ce\u683c",level:2},{value:"PEP 8 \u8981\u70b9",id:"pep-8-\u8981\u70b9",level:3},{value:"\u6587\u6863\u5b57\u7b26\u4e32",id:"\u6587\u6863\u5b57\u7b26\u4e32",level:3},{value:"\u73b0\u4ee3 Python \u7279\u6027",id:"\u73b0\u4ee3-python-\u7279\u6027",level:3},{value:"Review Checklist",id:"review-checklist",level:2},{value:"\u7c7b\u578b\u5b89\u5168",id:"\u7c7b\u578b\u5b89\u5168",level:3},{value:"\u5f02\u6b65\u4ee3\u7801",id:"\u5f02\u6b65\u4ee3\u7801",level:3},{value:"\u5f02\u5e38\u5904\u7406",id:"\u5f02\u5e38\u5904\u7406-1",level:3},{value:"\u6570\u636e\u7ed3\u6784",id:"\u6570\u636e\u7ed3\u6784",level:3},{value:"\u6d4b\u8bd5",id:"\u6d4b\u8bd5",level:3},{value:"\u4ee3\u7801\u98ce\u683c",id:"\u4ee3\u7801\u98ce\u683c-1",level:3},{value:"\u6027\u80fd",id:"\u6027\u80fd",level:3}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",input:"input",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"python-code-review-guide",children:"Python Code Review Guide"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"Python \u4ee3\u7801\u5ba1\u67e5\u6307\u5357\uff0c\u8986\u76d6\u7c7b\u578b\u6ce8\u89e3\u3001async/await\u3001\u6d4b\u8bd5\u3001\u5f02\u5e38\u5904\u7406\u3001\u6027\u80fd\u4f18\u5316\u7b49\u6838\u5fc3\u4e3b\u9898\u3002"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\u76ee\u5f55",children:"\u76ee\u5f55"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#%E7%B1%BB%E5%9E%8B%E6%B3%A8%E8%A7%A3",children:"\u7c7b\u578b\u6ce8\u89e3"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B",children:"\u5f02\u6b65\u7f16\u7a0b"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86",children:"\u5f02\u5e38\u5904\u7406"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#%E5%B8%B8%E8%A7%81%E9%99%B7%E9%98%B1",children:"\u5e38\u89c1\u9677\u9631"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#%E6%B5%8B%E8%AF%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5",children:"\u6d4b\u8bd5\u6700\u4f73\u5b9e\u8df5"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96",children:"\u6027\u80fd\u4f18\u5316"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#%E4%BB%A3%E7%A0%81%E9%A3%8E%E6%A0%BC",children:"\u4ee3\u7801\u98ce\u683c"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#review-checklist",children:"Review Checklist"})}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\u7c7b\u578b\u6ce8\u89e3",children:"\u7c7b\u578b\u6ce8\u89e3"}),"\n",(0,r.jsx)(n.h3,{id:"\u57fa\u7840\u7c7b\u578b\u6ce8\u89e3",children:"\u57fa\u7840\u7c7b\u578b\u6ce8\u89e3"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# \u274c \u6ca1\u6709\u7c7b\u578b\u6ce8\u89e3\uff0cIDE \u65e0\u6cd5\u63d0\u4f9b\u5e2e\u52a9\ndef process_data(data, count):\n    return data[:count]\n\n# \u2705 \u4f7f\u7528\u7c7b\u578b\u6ce8\u89e3\ndef process_data(data: str, count: int) -> str:\n    return data[:count]\n\n# \u2705 \u590d\u6742\u7c7b\u578b\u4f7f\u7528 typing \u6a21\u5757\nfrom typing import Optional, Union\n\ndef find_user(user_id: int) -> Optional[User]:\n    """\u8fd4\u56de\u7528\u6237\u6216 None"""\n    return db.get(user_id)\n\ndef handle_input(value: Union[str, int]) -> str:\n    """\u63a5\u53d7\u5b57\u7b26\u4e32\u6216\u6574\u6570"""\n    return str(value)\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\u5bb9\u5668\u7c7b\u578b\u6ce8\u89e3",children:"\u5bb9\u5668\u7c7b\u578b\u6ce8\u89e3"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from typing import List, Dict, Set, Tuple, Sequence\n\n# \u274c \u4e0d\u7cbe\u786e\u7684\u7c7b\u578b\ndef get_names(users: list) -> list:\n    return [u.name for u in users]\n\n# \u2705 \u7cbe\u786e\u7684\u5bb9\u5668\u7c7b\u578b\uff08Python 3.9+ \u53ef\u76f4\u63a5\u7528 list[User]\uff09\ndef get_names(users: List[User]) -> List[str]:\n    return [u.name for u in users]\n\n# \u2705 \u53ea\u8bfb\u5e8f\u5217\u7528 Sequence\uff08\u66f4\u7075\u6d3b\uff09\ndef process_items(items: Sequence[str]) -> int:\n    return len(items)\n\n# \u2705 \u5b57\u5178\u7c7b\u578b\ndef count_words(text: str) -> Dict[str, int]:\n    words: Dict[str, int] = {}\n    for word in text.split():\n        words[word] = words.get(word, 0) + 1\n    return words\n\n# \u2705 \u5143\u7ec4\uff08\u56fa\u5b9a\u957f\u5ea6\u548c\u7c7b\u578b\uff09\ndef get_point() -> Tuple[float, float]:\n    return (1.0, 2.0)\n\n# \u2705 \u53ef\u53d8\u957f\u5ea6\u5143\u7ec4\ndef get_scores() -> Tuple[int, ...]:\n    return (90, 85, 92, 88)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u6cdb\u578b\u4e0e-typevar",children:"\u6cdb\u578b\u4e0e TypeVar"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from typing import TypeVar, Generic, List, Callable\n\nT = TypeVar('T')\nK = TypeVar('K')\nV = TypeVar('V')\n\n# \u2705 \u6cdb\u578b\u51fd\u6570\ndef first(items: List[T]) -> T | None:\n    return items[0] if items else None\n\n# \u2705 \u6709\u7ea6\u675f\u7684 TypeVar\nfrom typing import Hashable\nH = TypeVar('H', bound=Hashable)\n\ndef dedupe(items: List[H]) -> List[H]:\n    return list(set(items))\n\n# \u2705 \u6cdb\u578b\u7c7b\nclass Cache(Generic[K, V]):\n    def __init__(self) -> None:\n        self._data: Dict[K, V] = {}\n\n    def get(self, key: K) -> V | None:\n        return self._data.get(key)\n\n    def set(self, key: K, value: V) -> None:\n        self._data[key] = value\n"})}),"\n",(0,r.jsx)(n.h3,{id:"callable-\u4e0e\u56de\u8c03\u51fd\u6570",children:"Callable \u4e0e\u56de\u8c03\u51fd\u6570"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from typing import Callable, Awaitable\n\n# \u2705 \u51fd\u6570\u7c7b\u578b\u6ce8\u89e3\nHandler = Callable[[str, int], bool]\n\ndef register_handler(name: str, handler: Handler) -> None:\n    handlers[name] = handler\n\n# \u2705 \u5f02\u6b65\u56de\u8c03\nAsyncHandler = Callable[[str], Awaitable[dict]]\n\nasync def fetch_with_handler(\n    url: str,\n    handler: AsyncHandler\n) -> dict:\n    return await handler(url)\n\n# \u2705 \u8fd4\u56de\u51fd\u6570\u7684\u51fd\u6570\ndef create_multiplier(factor: int) -> Callable[[int], int]:\n    def multiplier(x: int) -> int:\n        return x * factor\n    return multiplier\n"})}),"\n",(0,r.jsx)(n.h3,{id:"typeddict-\u4e0e\u7ed3\u6784\u5316\u6570\u636e",children:"TypedDict \u4e0e\u7ed3\u6784\u5316\u6570\u636e"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from typing import TypedDict, Required, NotRequired\n\n# \u2705 \u5b9a\u4e49\u5b57\u5178\u7ed3\u6784\nclass UserDict(TypedDict):\n    id: int\n    name: str\n    email: str\n    age: NotRequired[int]  # Python 3.11+\n\ndef create_user(data: UserDict) -> User:\n    return User(**data)\n\n# \u2705 \u90e8\u5206\u5fc5\u9700\u5b57\u6bb5\nclass ConfigDict(TypedDict, total=False):\n    debug: bool\n    timeout: int\n    host: Required[str]  # \u8fd9\u4e2a\u5fc5\u987b\u6709\n"})}),"\n",(0,r.jsx)(n.h3,{id:"protocol-\u4e0e\u7ed3\u6784\u5316\u5b50\u7c7b\u578b",children:"Protocol \u4e0e\u7ed3\u6784\u5316\u5b50\u7c7b\u578b"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from typing import Protocol, runtime_checkable\n\n# \u2705 \u5b9a\u4e49\u534f\u8bae\uff08\u9e2d\u5b50\u7c7b\u578b\u7684\u7c7b\u578b\u68c0\u67e5\uff09\nclass Readable(Protocol):\n    def read(self, size: int = -1) -> bytes: ...\n\nclass Closeable(Protocol):\n    def close(self) -> None: ...\n\n# \u7ec4\u5408\u534f\u8bae\nclass ReadableCloseable(Readable, Closeable, Protocol):\n    pass\n\ndef process_stream(stream: Readable) -> bytes:\n    return stream.read()\n\n# \u2705 \u8fd0\u884c\u65f6\u53ef\u68c0\u67e5\u7684\u534f\u8bae\n@runtime_checkable\nclass Drawable(Protocol):\n    def draw(self) -> None: ...\n\ndef render(obj: object) -> None:\n    if isinstance(obj, Drawable):  # \u8fd0\u884c\u65f6\u68c0\u67e5\n        obj.draw()\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\u5f02\u6b65\u7f16\u7a0b",children:"\u5f02\u6b65\u7f16\u7a0b"}),"\n",(0,r.jsx)(n.h3,{id:"asyncawait-\u57fa\u7840",children:"async/await \u57fa\u7840"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import asyncio\n\n# \u274c \u540c\u6b65\u963b\u585e\u8c03\u7528\ndef fetch_all_sync(urls: list[str]) -> list[str]:\n    results = []\n    for url in urls:\n        results.append(requests.get(url).text)  # \u4e32\u884c\u6267\u884c\n    return results\n\n# \u2705 \u5f02\u6b65\u5e76\u53d1\u8c03\u7528\nasync def fetch_url(url: str) -> str:\n    async with aiohttp.ClientSession() as session:\n        async with session.get(url) as response:\n            return await response.text()\n\nasync def fetch_all(urls: list[str]) -> list[str]:\n    tasks = [fetch_url(url) for url in urls]\n    return await asyncio.gather(*tasks)  # \u5e76\u53d1\u6267\u884c\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u5f02\u6b65\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668",children:"\u5f02\u6b65\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from contextlib import asynccontextmanager\nfrom typing import AsyncIterator\n\n# \u2705 \u5f02\u6b65\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u7c7b\nclass AsyncDatabase:\n    async def __aenter__(self) -> 'AsyncDatabase':\n        await self.connect()\n        return self\n\n    async def __aexit__(self, exc_type, exc_val, exc_tb) -> None:\n        await self.disconnect()\n\n# \u2705 \u4f7f\u7528\u88c5\u9970\u5668\n@asynccontextmanager\nasync def get_connection() -> AsyncIterator[Connection]:\n    conn = await create_connection()\n    try:\n        yield conn\n    finally:\n        await conn.close()\n\nasync def query_data():\n    async with get_connection() as conn:\n        return await conn.fetch(\"SELECT * FROM users\")\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u5f02\u6b65\u8fed\u4ee3\u5668",children:"\u5f02\u6b65\u8fed\u4ee3\u5668"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from typing import AsyncIterator\n\n# \u2705 \u5f02\u6b65\u751f\u6210\u5668\nasync def fetch_pages(url: str) -> AsyncIterator[dict]:\n    page = 1\n    while True:\n        data = await fetch_page(url, page)\n        if not data['items']:\n            break\n        yield data\n        page += 1\n\n# \u2705 \u4f7f\u7528\u5f02\u6b65\u8fed\u4ee3\nasync def process_all_pages():\n    async for page in fetch_pages(\"https://api.example.com\"):\n        await process_page(page)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u4efb\u52a1\u7ba1\u7406\u4e0e\u53d6\u6d88",children:"\u4efb\u52a1\u7ba1\u7406\u4e0e\u53d6\u6d88"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'import asyncio\n\n# \u274c \u5fd8\u8bb0\u5904\u7406\u53d6\u6d88\nasync def bad_worker():\n    while True:\n        await do_work()  # \u65e0\u6cd5\u6b63\u5e38\u53d6\u6d88\n\n# \u2705 \u6b63\u786e\u5904\u7406\u53d6\u6d88\nasync def good_worker():\n    try:\n        while True:\n            await do_work()\n    except asyncio.CancelledError:\n        await cleanup()  # \u6e05\u7406\u8d44\u6e90\n        raise  # \u91cd\u65b0\u629b\u51fa\uff0c\u8ba9\u8c03\u7528\u8005\u77e5\u9053\u5df2\u53d6\u6d88\n\n# \u2705 \u8d85\u65f6\u63a7\u5236\nasync def fetch_with_timeout(url: str) -> str:\n    try:\n        async with asyncio.timeout(10):  # Python 3.11+\n            return await fetch_url(url)\n    except asyncio.TimeoutError:\n        return ""\n\n# \u2705 \u4efb\u52a1\u7ec4\uff08Python 3.11+\uff09\nasync def fetch_multiple():\n    async with asyncio.TaskGroup() as tg:\n        task1 = tg.create_task(fetch_url("url1"))\n        task2 = tg.create_task(fetch_url("url2"))\n    # \u6240\u6709\u4efb\u52a1\u5b8c\u6210\u540e\u81ea\u52a8\u7b49\u5f85\uff0c\u5f02\u5e38\u4f1a\u4f20\u64ad\n    return task1.result(), task2.result()\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\u540c\u6b65\u4e0e\u5f02\u6b65\u6df7\u5408",children:"\u540c\u6b65\u4e0e\u5f02\u6b65\u6df7\u5408"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import asyncio\nfrom concurrent.futures import ThreadPoolExecutor\n\n# \u2705 \u5728\u5f02\u6b65\u4ee3\u7801\u4e2d\u8fd0\u884c\u540c\u6b65\u51fd\u6570\nasync def run_sync_in_async():\n    loop = asyncio.get_event_loop()\n    # \u4f7f\u7528\u7ebf\u7a0b\u6c60\u6267\u884c\u963b\u585e\u64cd\u4f5c\n    result = await loop.run_in_executor(\n        None,  # \u9ed8\u8ba4\u7ebf\u7a0b\u6c60\n        blocking_io_function,\n        arg1, arg2\n    )\n    return result\n\n# \u2705 \u5728\u540c\u6b65\u4ee3\u7801\u4e2d\u8fd0\u884c\u5f02\u6b65\u51fd\u6570\ndef run_async_in_sync():\n    return asyncio.run(async_function())\n\n# \u274c \u4e0d\u8981\u5728\u5f02\u6b65\u4ee3\u7801\u4e2d\u4f7f\u7528 time.sleep\nasync def bad_delay():\n    time.sleep(1)  # \u4f1a\u963b\u585e\u6574\u4e2a\u4e8b\u4ef6\u5faa\u73af\uff01\n\n# \u2705 \u4f7f\u7528 asyncio.sleep\nasync def good_delay():\n    await asyncio.sleep(1)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u4fe1\u53f7\u91cf\u4e0e\u9650\u6d41",children:"\u4fe1\u53f7\u91cf\u4e0e\u9650\u6d41"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import asyncio\n\n# \u2705 \u4f7f\u7528\u4fe1\u53f7\u91cf\u9650\u5236\u5e76\u53d1\nasync def fetch_with_limit(urls: list[str], max_concurrent: int = 10):\n    semaphore = asyncio.Semaphore(max_concurrent)\n\n    async def fetch_one(url: str) -> str:\n        async with semaphore:\n            return await fetch_url(url)\n\n    return await asyncio.gather(*[fetch_one(url) for url in urls])\n\n# \u2705 \u4f7f\u7528 asyncio.Queue \u5b9e\u73b0\u751f\u4ea7\u8005-\u6d88\u8d39\u8005\nasync def producer_consumer():\n    queue: asyncio.Queue[str] = asyncio.Queue(maxsize=100)\n\n    async def producer():\n        for item in items:\n            await queue.put(item)\n        await queue.put(None)  # \u7ed3\u675f\u4fe1\u53f7\n\n    async def consumer():\n        while True:\n            item = await queue.get()\n            if item is None:\n                break\n            await process(item)\n            queue.task_done()\n\n    await asyncio.gather(producer(), consumer())\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\u5f02\u5e38\u5904\u7406",children:"\u5f02\u5e38\u5904\u7406"}),"\n",(0,r.jsx)(n.h3,{id:"\u5f02\u5e38\u6355\u83b7\u6700\u4f73\u5b9e\u8df5",children:"\u5f02\u5e38\u6355\u83b7\u6700\u4f73\u5b9e\u8df5"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# \u274c Catching too broad\ntry:\n    result = risky_operation()\nexcept:  # Catches everything, even KeyboardInterrupt!\n    pass\n\n# \u274c \u6355\u83b7 Exception \u4f46\u4e0d\u5904\u7406\ntry:\n    result = risky_operation()\nexcept Exception:\n    pass  # \u541e\u6389\u6240\u6709\u5f02\u5e38\uff0c\u96be\u4ee5\u8c03\u8bd5\n\n# \u2705 Catch specific exceptions\ntry:\n    result = risky_operation()\nexcept ValueError as e:\n    logger.error(f"Invalid value: {e}")\n    raise\nexcept IOError as e:\n    logger.error(f"IO error: {e}")\n    return default_value\n\n# \u2705 \u591a\u4e2a\u5f02\u5e38\u7c7b\u578b\ntry:\n    result = parse_and_process(data)\nexcept (ValueError, TypeError, KeyError) as e:\n    logger.error(f"Data error: {e}")\n    raise DataProcessingError(str(e)) from e\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\u5f02\u5e38\u94fe",children:"\u5f02\u5e38\u94fe"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# \u274c \u4e22\u5931\u539f\u59cb\u5f02\u5e38\u4fe1\u606f\ntry:\n    result = external_api.call()\nexcept APIError as e:\n    raise RuntimeError("API failed")  # \u4e22\u5931\u4e86\u539f\u56e0\n\n# \u2705 \u4f7f\u7528 from \u4fdd\u7559\u5f02\u5e38\u94fe\ntry:\n    result = external_api.call()\nexcept APIError as e:\n    raise RuntimeError("API failed") from e\n\n# \u2705 \u663e\u5f0f\u65ad\u5f00\u5f02\u5e38\u94fe\uff08\u5c11\u89c1\u60c5\u51b5\uff09\ntry:\n    result = external_api.call()\nexcept APIError:\n    raise RuntimeError("API failed") from None\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\u81ea\u5b9a\u4e49\u5f02\u5e38",children:"\u81ea\u5b9a\u4e49\u5f02\u5e38"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# \u2705 \u5b9a\u4e49\u4e1a\u52a1\u5f02\u5e38\u5c42\u6b21\u7ed3\u6784\nclass AppError(Exception):\n    """\u5e94\u7528\u57fa\u7840\u5f02\u5e38"""\n    pass\n\nclass ValidationError(AppError):\n    """\u6570\u636e\u9a8c\u8bc1\u9519\u8bef"""\n    def __init__(self, field: str, message: str):\n        self.field = field\n        self.message = message\n        super().__init__(f"{field}: {message}")\n\nclass NotFoundError(AppError):\n    """\u8d44\u6e90\u672a\u627e\u5230"""\n    def __init__(self, resource: str, id: str | int):\n        self.resource = resource\n        self.id = id\n        super().__init__(f"{resource} with id {id} not found")\n\n# \u4f7f\u7528\ndef get_user(user_id: int) -> User:\n    user = db.get(user_id)\n    if not user:\n        raise NotFoundError("User", user_id)\n    return user\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u4e2d\u7684\u5f02\u5e38",children:"\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u4e2d\u7684\u5f02\u5e38"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from contextlib import contextmanager\n\n# \u2705 \u6b63\u786e\u5904\u7406\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u4e2d\u7684\u5f02\u5e38\n@contextmanager\ndef transaction():\n    conn = get_connection()\n    try:\n        yield conn\n        conn.commit()\n    except Exception:\n        conn.rollback()\n        raise\n    finally:\n        conn.close()\n\n# \u2705 \u4f7f\u7528 ExceptionGroup\uff08Python 3.11+\uff09\ndef process_batch(items: list) -> None:\n    errors = []\n    for item in items:\n        try:\n            process(item)\n        except Exception as e:\n            errors.append(e)\n\n    if errors:\n        raise ExceptionGroup("Batch processing failed", errors)\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\u5e38\u89c1\u9677\u9631",children:"\u5e38\u89c1\u9677\u9631"}),"\n",(0,r.jsx)(n.h3,{id:"\u53ef\u53d8\u9ed8\u8ba4\u53c2\u6570",children:"\u53ef\u53d8\u9ed8\u8ba4\u53c2\u6570"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# \u274c Mutable default arguments\ndef add_item(item, items=[]):  # Bug! Shared across calls\n    items.append(item)\n    return items\n\n# \u95ee\u9898\u6f14\u793a\nadd_item(1)  # [1]\nadd_item(2)  # [1, 2] \u800c\u4e0d\u662f [2]\uff01\n\n# \u2705 Use None as default\ndef add_item(item, items=None):\n    if items is None:\n        items = []\n    items.append(item)\n    return items\n\n# \u2705 \u6216\u4f7f\u7528 dataclass \u7684 field\nfrom dataclasses import dataclass, field\n\n@dataclass\nclass Container:\n    items: list = field(default_factory=list)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u53ef\u53d8\u7c7b\u5c5e\u6027",children:"\u53ef\u53d8\u7c7b\u5c5e\u6027"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# \u274c Using mutable class attributes\nclass User:\n    permissions = []  # Shared across all instances!\n\n# \u95ee\u9898\u6f14\u793a\nu1 = User()\nu2 = User()\nu1.permissions.append("admin")\nprint(u2.permissions)  # ["admin"] - \u88ab\u610f\u5916\u5171\u4eab\uff01\n\n# \u2705 Initialize in __init__\nclass User:\n    def __init__(self):\n        self.permissions = []\n\n# \u2705 \u4f7f\u7528 dataclass\n@dataclass\nclass User:\n    permissions: list = field(default_factory=list)\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\u5faa\u73af\u4e2d\u7684\u95ed\u5305",children:"\u5faa\u73af\u4e2d\u7684\u95ed\u5305"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# \u274c \u95ed\u5305\u6355\u83b7\u5faa\u73af\u53d8\u91cf\nfuncs = []\nfor i in range(3):\n    funcs.append(lambda: i)\n\nprint([f() for f in funcs])  # [2, 2, 2] \u800c\u4e0d\u662f [0, 1, 2]\uff01\n\n# \u2705 \u4f7f\u7528\u9ed8\u8ba4\u53c2\u6570\u6355\u83b7\u503c\nfuncs = []\nfor i in range(3):\n    funcs.append(lambda i=i: i)\n\nprint([f() for f in funcs])  # [0, 1, 2]\n\n# \u2705 \u4f7f\u7528 functools.partial\nfrom functools import partial\n\nfuncs = [partial(lambda x: x, i) for i in range(3)]\n"})}),"\n",(0,r.jsx)(n.h3,{id:"is-vs-",children:"is vs =="}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# \u274c \u7528 is \u6bd4\u8f83\u503c\nif x is 1000:  # \u53ef\u80fd\u4e0d\u5de5\u4f5c\uff01\n    pass\n\n# Python \u4f1a\u7f13\u5b58\u5c0f\u6574\u6570 (-5 \u5230 256)\na = 256\nb = 256\na is b  # True\n\na = 257\nb = 257\na is b  # False\uff01\n\n# \u2705 \u7528 == \u6bd4\u8f83\u503c\nif x == 1000:\n    pass\n\n# \u2705 is \u53ea\u7528\u4e8e None \u548c\u5355\u4f8b\nif x is None:\n    pass\n\nif x is True:  # \u4e25\u683c\u68c0\u67e5\u5e03\u5c14\u503c\n    pass\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u5b57\u7b26\u4e32\u62fc\u63a5\u6027\u80fd",children:"\u5b57\u7b26\u4e32\u62fc\u63a5\u6027\u80fd"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# \u274c \u5faa\u73af\u4e2d\u62fc\u63a5\u5b57\u7b26\u4e32\nresult = ""\nfor item in large_list:\n    result += str(item)  # O(n\xb2) \u590d\u6742\u5ea6\n\n# \u2705 \u4f7f\u7528 join\nresult = "".join(str(item) for item in large_list)  # O(n)\n\n# \u2705 \u4f7f\u7528 StringIO \u6784\u5efa\u5927\u5b57\u7b26\u4e32\nfrom io import StringIO\n\nbuffer = StringIO()\nfor item in large_list:\n    buffer.write(str(item))\nresult = buffer.getvalue()\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\u6d4b\u8bd5\u6700\u4f73\u5b9e\u8df5",children:"\u6d4b\u8bd5\u6700\u4f73\u5b9e\u8df5"}),"\n",(0,r.jsx)(n.h3,{id:"pytest-\u57fa\u7840",children:"pytest \u57fa\u7840"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'import pytest\n\n# \u2705 \u6e05\u6670\u7684\u6d4b\u8bd5\u547d\u540d\ndef test_user_creation_with_valid_email():\n    user = User(email="test@example.com")\n    assert user.email == "test@example.com"\n\ndef test_user_creation_with_invalid_email_raises_error():\n    with pytest.raises(ValidationError):\n        User(email="invalid")\n\n# \u2705 \u4f7f\u7528\u53c2\u6570\u5316\u6d4b\u8bd5\n@pytest.mark.parametrize("input,expected", [\n    ("hello", "HELLO"),\n    ("World", "WORLD"),\n    ("", ""),\n    ("123", "123"),\n])\ndef test_uppercase(input: str, expected: str):\n    assert input.upper() == expected\n\n# \u2705 \u6d4b\u8bd5\u5f02\u5e38\ndef test_division_by_zero():\n    with pytest.raises(ZeroDivisionError) as exc_info:\n        1 / 0\n    assert "division by zero" in str(exc_info.value)\n'})}),"\n",(0,r.jsx)(n.h3,{id:"fixtures",children:"Fixtures"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'import pytest\nfrom typing import Generator\n\n# \u2705 \u57fa\u7840 fixture\n@pytest.fixture\ndef user() -> User:\n    return User(name="Test User", email="test@example.com")\n\ndef test_user_name(user: User):\n    assert user.name == "Test User"\n\n# \u2705 \u5e26\u6e05\u7406\u7684 fixture\n@pytest.fixture\ndef database() -> Generator[Database, None, None]:\n    db = Database()\n    db.connect()\n    yield db\n    db.disconnect()  # \u6d4b\u8bd5\u540e\u6e05\u7406\n\n# \u2705 \u5f02\u6b65 fixture\n@pytest.fixture\nasync def async_client() -> AsyncGenerator[AsyncClient, None]:\n    async with AsyncClient() as client:\n        yield client\n\n# \u2705 \u5171\u4eab fixture\uff08conftest.py\uff09\n# conftest.py\n@pytest.fixture(scope="session")\ndef app():\n    """\u6574\u4e2a\u6d4b\u8bd5\u4f1a\u8bdd\u5171\u4eab\u7684 app \u5b9e\u4f8b"""\n    return create_app()\n\n@pytest.fixture(scope="module")\ndef db(app):\n    """\u6bcf\u4e2a\u6d4b\u8bd5\u6a21\u5757\u5171\u4eab\u7684\u6570\u636e\u5e93\u8fde\u63a5"""\n    return app.db\n'})}),"\n",(0,r.jsx)(n.h3,{id:"mock-\u4e0e-patch",children:"Mock \u4e0e Patch"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from unittest.mock import Mock, patch, AsyncMock\n\n# \u2705 Mock \u5916\u90e8\u4f9d\u8d56\ndef test_send_email():\n    mock_client = Mock()\n    mock_client.send.return_value = True\n\n    service = EmailService(client=mock_client)\n    result = service.send_welcome_email("user@example.com")\n\n    assert result is True\n    mock_client.send.assert_called_once_with(\n        to="user@example.com",\n        subject="Welcome!",\n        body=ANY,\n    )\n\n# \u2705 Patch \u6a21\u5757\u7ea7\u51fd\u6570\n@patch("myapp.services.external_api.call")\ndef test_with_patched_api(mock_call):\n    mock_call.return_value = {"status": "ok"}\n\n    result = process_data()\n\n    assert result["status"] == "ok"\n\n# \u2705 \u5f02\u6b65 Mock\nasync def test_async_function():\n    mock_fetch = AsyncMock(return_value={"data": "test"})\n\n    with patch("myapp.client.fetch", mock_fetch):\n        result = await get_data()\n\n    assert result == {"data": "test"}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\u6d4b\u8bd5\u7ec4\u7ec7",children:"\u6d4b\u8bd5\u7ec4\u7ec7"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# \u2705 \u4f7f\u7528\u7c7b\u7ec4\u7ec7\u76f8\u5173\u6d4b\u8bd5\nclass TestUserAuthentication:\n    """\u7528\u6237\u8ba4\u8bc1\u76f8\u5173\u6d4b\u8bd5"""\n\n    def test_login_with_valid_credentials(self, user):\n        assert authenticate(user.email, "password") is True\n\n    def test_login_with_invalid_password(self, user):\n        assert authenticate(user.email, "wrong") is False\n\n    def test_login_locks_after_failed_attempts(self, user):\n        for _ in range(5):\n            authenticate(user.email, "wrong")\n        assert user.is_locked is True\n\n# \u2705 \u4f7f\u7528 mark \u6807\u8bb0\u6d4b\u8bd5\n@pytest.mark.slow\ndef test_large_data_processing():\n    pass\n\n@pytest.mark.integration\ndef test_database_connection():\n    pass\n\n# \u8fd0\u884c\u7279\u5b9a\u6807\u8bb0\u7684\u6d4b\u8bd5\uff1apytest -m "not slow"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\u8986\u76d6\u7387\u4e0e\u8d28\u91cf",children:"\u8986\u76d6\u7387\u4e0e\u8d28\u91cf"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# pytest.ini \u6216 pyproject.toml\n[tool.pytest.ini_options]\naddopts = "--cov=myapp --cov-report=term-missing --cov-fail-under=80"\ntestpaths = ["tests"]\n\n# \u2705 \u6d4b\u8bd5\u8fb9\u754c\u60c5\u51b5\ndef test_empty_input():\n    assert process([]) == []\n\ndef test_none_input():\n    with pytest.raises(TypeError):\n        process(None)\n\ndef test_large_input():\n    large_data = list(range(100000))\n    result = process(large_data)\n    assert len(result) == 100000\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\u6027\u80fd\u4f18\u5316",children:"\u6027\u80fd\u4f18\u5316"}),"\n",(0,r.jsx)(n.h3,{id:"\u6570\u636e\u7ed3\u6784\u9009\u62e9",children:"\u6570\u636e\u7ed3\u6784\u9009\u62e9"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# \u274c \u5217\u8868\u67e5\u627e O(n)\nif item in large_list:  # \u6162\n    pass\n\n# \u2705 \u96c6\u5408\u67e5\u627e O(1)\nlarge_set = set(large_list)\nif item in large_set:  # \u5feb\n    pass\n\n# \u2705 \u4f7f\u7528 collections \u6a21\u5757\nfrom collections import Counter, defaultdict, deque\n\n# \u8ba1\u6570\nword_counts = Counter(words)\nmost_common = word_counts.most_common(10)\n\n# \u9ed8\u8ba4\u5b57\u5178\ngraph = defaultdict(list)\ngraph[node].append(neighbor)\n\n# \u53cc\u7aef\u961f\u5217\uff08\u4e24\u7aef\u64cd\u4f5c O(1)\uff09\nqueue = deque()\nqueue.appendleft(item)  # O(1) vs list.insert(0, item) O(n)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u751f\u6210\u5668\u4e0e\u8fed\u4ee3\u5668",children:"\u751f\u6210\u5668\u4e0e\u8fed\u4ee3\u5668"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# \u274c \u4e00\u6b21\u6027\u52a0\u8f7d\u6240\u6709\u6570\u636e\ndef get_all_users():\n    return [User(row) for row in db.fetch_all()]  # \u5185\u5b58\u5360\u7528\u5927\n\n# \u2705 \u4f7f\u7528\u751f\u6210\u5668\ndef get_all_users():\n    for row in db.fetch_all():\n        yield User(row)  # \u61d2\u52a0\u8f7d\n\n# \u2705 \u751f\u6210\u5668\u8868\u8fbe\u5f0f\nsum_of_squares = sum(x**2 for x in range(1000000))  # \u4e0d\u521b\u5efa\u5217\u8868\n\n# \u2705 itertools \u6a21\u5757\nfrom itertools import islice, chain, groupby\n\n# \u53ea\u53d6\u524d 10 \u4e2a\nfirst_10 = list(islice(infinite_generator(), 10))\n\n# \u94fe\u63a5\u591a\u4e2a\u8fed\u4ee3\u5668\nall_items = chain(list1, list2, list3)\n\n# \u5206\u7ec4\nfor key, group in groupby(sorted(items, key=get_key), key=get_key):\n    process_group(key, list(group))\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u7f13\u5b58",children:"\u7f13\u5b58"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from functools import lru_cache, cache\n\n# \u2705 LRU \u7f13\u5b58\n@lru_cache(maxsize=128)\ndef expensive_computation(n: int) -> int:\n    return sum(i**2 for i in range(n))\n\n# \u2705 \u65e0\u9650\u7f13\u5b58\uff08Python 3.9+\uff09\n@cache\ndef fibonacci(n: int) -> int:\n    if n < 2:\n        return n\n    return fibonacci(n - 1) + fibonacci(n - 2)\n\n# \u2705 \u624b\u52a8\u7f13\u5b58\uff08\u9700\u8981\u66f4\u591a\u63a7\u5236\u65f6\uff09\nclass DataService:\n    def __init__(self):\n        self._cache: dict[str, Any] = {}\n        self._cache_ttl: dict[str, float] = {}\n\n    def get_data(self, key: str) -> Any:\n        if key in self._cache:\n            if time.time() < self._cache_ttl[key]:\n                return self._cache[key]\n\n        data = self._fetch_data(key)\n        self._cache[key] = data\n        self._cache_ttl[key] = time.time() + 300  # 5 \u5206\u949f\n        return data\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u5e76\u884c\u5904\u7406",children:"\u5e76\u884c\u5904\u7406"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from concurrent.futures import ThreadPoolExecutor, ProcessPoolExecutor\n\n# \u2705 IO \u5bc6\u96c6\u578b\u4f7f\u7528\u7ebf\u7a0b\u6c60\ndef fetch_all_urls(urls: list[str]) -> list[str]:\n    with ThreadPoolExecutor(max_workers=10) as executor:\n        results = list(executor.map(fetch_url, urls))\n    return results\n\n# \u2705 CPU \u5bc6\u96c6\u578b\u4f7f\u7528\u8fdb\u7a0b\u6c60\ndef process_large_dataset(data: list) -> list:\n    with ProcessPoolExecutor() as executor:\n        results = list(executor.map(heavy_computation, data))\n    return results\n\n# \u2705 \u4f7f\u7528 as_completed \u83b7\u53d6\u6700\u5148\u5b8c\u6210\u7684\u7ed3\u679c\nfrom concurrent.futures import as_completed\n\nwith ThreadPoolExecutor() as executor:\n    futures = {executor.submit(fetch, url): url for url in urls}\n    for future in as_completed(futures):\n        url = futures[future]\n        try:\n            result = future.result()\n        except Exception as e:\n            print(f"{url} failed: {e}")\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\u4ee3\u7801\u98ce\u683c",children:"\u4ee3\u7801\u98ce\u683c"}),"\n",(0,r.jsx)(n.h3,{id:"pep-8-\u8981\u70b9",children:"PEP 8 \u8981\u70b9"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# \u2705 \u547d\u540d\u89c4\u8303\nclass MyClass:  # \u7c7b\u540d PascalCase\n    MAX_SIZE = 100  # \u5e38\u91cf UPPER_SNAKE_CASE\n\n    def method_name(self):  # \u65b9\u6cd5 snake_case\n        local_var = 1  # \u53d8\u91cf snake_case\n\n# \u2705 \u5bfc\u5165\u987a\u5e8f\n# 1. \u6807\u51c6\u5e93\nimport os\nimport sys\nfrom typing import Optional\n\n# 2. \u7b2c\u4e09\u65b9\u5e93\nimport numpy as np\nimport pandas as pd\n\n# 3. \u672c\u5730\u6a21\u5757\nfrom myapp import config\nfrom myapp.utils import helper\n\n# \u2705 \u884c\u957f\u5ea6\u9650\u5236\uff0879 \u6216 88 \u5b57\u7b26\uff09\n# \u957f\u8868\u8fbe\u5f0f\u7684\u6362\u884c\nresult = (\n    long_function_name(arg1, arg2, arg3)\n    + another_long_function(arg4, arg5)\n)\n\n# \u2705 \u7a7a\u884c\u89c4\u8303\nclass MyClass:\n    """\u7c7b\u6587\u6863\u5b57\u7b26\u4e32"""\n\n    def method_one(self):\n        pass\n\n    def method_two(self):  # \u65b9\u6cd5\u95f4\u4e00\u4e2a\u7a7a\u884c\n        pass\n\n\ndef top_level_function():  # \u9876\u5c42\u5b9a\u4e49\u95f4\u4e24\u4e2a\u7a7a\u884c\n    pass\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\u6587\u6863\u5b57\u7b26\u4e32",children:"\u6587\u6863\u5b57\u7b26\u4e32"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# \u2705 Google \u98ce\u683c\u6587\u6863\u5b57\u7b26\u4e32\ndef calculate_area(width: float, height: float) -> float:\n    """\u8ba1\u7b97\u77e9\u5f62\u9762\u79ef\u3002\n\n    Args:\n        width: \u77e9\u5f62\u7684\u5bbd\u5ea6\uff08\u5fc5\u987b\u4e3a\u6b63\u6570\uff09\u3002\n        height: \u77e9\u5f62\u7684\u9ad8\u5ea6\uff08\u5fc5\u987b\u4e3a\u6b63\u6570\uff09\u3002\n\n    Returns:\n        \u77e9\u5f62\u7684\u9762\u79ef\u3002\n\n    Raises:\n        ValueError: \u5982\u679c width \u6216 height \u4e3a\u8d1f\u6570\u3002\n\n    Example:\n        >>> calculate_area(3, 4)\n        12.0\n    """\n    if width < 0 or height < 0:\n        raise ValueError("Dimensions must be positive")\n    return width * height\n\n# \u2705 \u7c7b\u6587\u6863\u5b57\u7b26\u4e32\nclass DataProcessor:\n    """\u5904\u7406\u548c\u8f6c\u6362\u6570\u636e\u7684\u5de5\u5177\u7c7b\u3002\n\n    Attributes:\n        source: \u6570\u636e\u6765\u6e90\u8def\u5f84\u3002\n        format: \u8f93\u51fa\u683c\u5f0f\uff08\'json\' \u6216 \'csv\'\uff09\u3002\n\n    Example:\n        >>> processor = DataProcessor("data.csv")\n        >>> processor.process()\n    """\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\u73b0\u4ee3-python-\u7279\u6027",children:"\u73b0\u4ee3 Python \u7279\u6027"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# \u2705 f-string\uff08Python 3.6+\uff09\nname = "World"\nprint(f"Hello, {name}!")\n\n# \u5e26\u8868\u8fbe\u5f0f\nprint(f"Result: {1 + 2 = }")  # "Result: 1 + 2 = 3"\n\n# \u2705 \u6d77\u8c61\u8fd0\u7b97\u7b26\uff08Python 3.8+\uff09\nif (n := len(items)) > 10:\n    print(f"List has {n} items")\n\n# \u2705 \u4f4d\u7f6e\u53c2\u6570\u5206\u9694\u7b26\uff08Python 3.8+\uff09\ndef greet(name, /, greeting="Hello", *, punctuation="!"):\n    """name \u53ea\u80fd\u4f4d\u7f6e\u4f20\u53c2\uff0cpunctuation \u53ea\u80fd\u5173\u952e\u5b57\u4f20\u53c2"""\n    return f"{greeting}, {name}{punctuation}"\n\n# \u2705 \u6a21\u5f0f\u5339\u914d\uff08Python 3.10+\uff09\ndef handle_response(response: dict):\n    match response:\n        case {"status": "ok", "data": data}:\n            return process_data(data)\n        case {"status": "error", "message": msg}:\n            raise APIError(msg)\n        case _:\n            raise ValueError("Unknown response format")\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"review-checklist",children:"Review Checklist"}),"\n",(0,r.jsx)(n.h3,{id:"\u7c7b\u578b\u5b89\u5168",children:"\u7c7b\u578b\u5b89\u5168"}),"\n",(0,r.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u51fd\u6570\u6709\u7c7b\u578b\u6ce8\u89e3\uff08\u53c2\u6570\u548c\u8fd4\u56de\u503c\uff09"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u4f7f\u7528 ",(0,r.jsx)(n.code,{children:"Optional"})," \u660e\u786e\u53ef\u80fd\u4e3a None"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u6cdb\u578b\u7c7b\u578b\u6b63\u786e\u4f7f\u7528"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","mypy \u68c0\u67e5\u901a\u8fc7\uff08\u65e0\u9519\u8bef\uff09"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u907f\u514d\u4f7f\u7528 ",(0,r.jsx)(n.code,{children:"Any"}),"\uff0c\u5fc5\u8981\u65f6\u6dfb\u52a0\u6ce8\u91ca\u8bf4\u660e"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"\u5f02\u6b65\u4ee3\u7801",children:"\u5f02\u6b65\u4ee3\u7801"}),"\n",(0,r.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","async/await \u6b63\u786e\u914d\u5bf9\u4f7f\u7528"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u6ca1\u6709\u5728\u5f02\u6b65\u4ee3\u7801\u4e2d\u4f7f\u7528\u963b\u585e\u8c03\u7528"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u6b63\u786e\u5904\u7406 ",(0,r.jsx)(n.code,{children:"CancelledError"})]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u4f7f\u7528 ",(0,r.jsx)(n.code,{children:"asyncio.gather"})," \u6216 ",(0,r.jsx)(n.code,{children:"TaskGroup"})," \u5e76\u53d1\u6267\u884c"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u8d44\u6e90\u6b63\u786e\u6e05\u7406\uff08async context manager\uff09"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"\u5f02\u5e38\u5904\u7406-1",children:"\u5f02\u5e38\u5904\u7406"}),"\n",(0,r.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u6355\u83b7\u7279\u5b9a\u5f02\u5e38\u7c7b\u578b\uff0c\u4e0d\u4f7f\u7528\u88f8 ",(0,r.jsx)(n.code,{children:"except:"})]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u5f02\u5e38\u94fe\u4f7f\u7528 ",(0,r.jsx)(n.code,{children:"from"})," \u4fdd\u7559\u539f\u56e0"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u81ea\u5b9a\u4e49\u5f02\u5e38\u7ee7\u627f\u81ea\u5408\u9002\u7684\u57fa\u7c7b"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u5f02\u5e38\u4fe1\u606f\u6709\u610f\u4e49\uff0c\u4fbf\u4e8e\u8c03\u8bd5"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"\u6570\u636e\u7ed3\u6784",children:"\u6570\u636e\u7ed3\u6784"}),"\n",(0,r.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u6ca1\u6709\u4f7f\u7528\u53ef\u53d8\u9ed8\u8ba4\u53c2\u6570\uff08list\u3001dict\u3001set\uff09"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u7c7b\u5c5e\u6027\u4e0d\u662f\u53ef\u53d8\u5bf9\u8c61"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u9009\u62e9\u6b63\u786e\u7684\u6570\u636e\u7ed3\u6784\uff08set vs list \u67e5\u627e\uff09"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u5927\u6570\u636e\u96c6\u4f7f\u7528\u751f\u6210\u5668\u800c\u975e\u5217\u8868"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"\u6d4b\u8bd5",children:"\u6d4b\u8bd5"}),"\n",(0,r.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u6d4b\u8bd5\u8986\u76d6\u7387\u8fbe\u6807\uff08\u5efa\u8bae \u226580%\uff09"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u6d4b\u8bd5\u547d\u540d\u6e05\u6670\u63cf\u8ff0\u6d4b\u8bd5\u573a\u666f"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u8fb9\u754c\u60c5\u51b5\u6709\u6d4b\u8bd5\u8986\u76d6"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Mock \u6b63\u786e\u9694\u79bb\u5916\u90e8\u4f9d\u8d56"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u5f02\u6b65\u4ee3\u7801\u6709\u5bf9\u5e94\u7684\u5f02\u6b65\u6d4b\u8bd5"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"\u4ee3\u7801\u98ce\u683c-1",children:"\u4ee3\u7801\u98ce\u683c"}),"\n",(0,r.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u9075\u5faa PEP 8 \u98ce\u683c\u6307\u5357"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u51fd\u6570\u548c\u7c7b\u6709 docstring"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u5bfc\u5165\u987a\u5e8f\u6b63\u786e\uff08\u6807\u51c6\u5e93\u3001\u7b2c\u4e09\u65b9\u3001\u672c\u5730\uff09"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u547d\u540d\u4e00\u81f4\u4e14\u6709\u610f\u4e49"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u4f7f\u7528\u73b0\u4ee3 Python \u7279\u6027\uff08f-string\u3001walrus operator \u7b49\uff09"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"\u6027\u80fd",children:"\u6027\u80fd"}),"\n",(0,r.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u907f\u514d\u5faa\u73af\u4e2d\u91cd\u590d\u521b\u5efa\u5bf9\u8c61"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u5b57\u7b26\u4e32\u62fc\u63a5\u4f7f\u7528 join"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u5408\u7406\u4f7f\u7528\u7f13\u5b58\uff08@lru_cache\uff09"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","IO/CPU \u5bc6\u96c6\u578b\u4f7f\u7528\u5408\u9002\u7684\u5e76\u884c\u65b9\u5f0f"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453(e,n,s){s.d(n,{R:()=>a,x:()=>l});var t=s(6540);const r={},i=t.createContext(r);function a(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);