<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-L0-enterprise/standards/testing-standards" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">测试规范 | W3Bank Knowledge Wiki</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://w3bank.github.io/docs-engine/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://w3bank.github.io/docs-engine/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://w3bank.github.io/docs-engine/docs/L0-enterprise/standards/testing-standards"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="测试规范 | W3Bank Knowledge Wiki"><meta data-rh="true" name="description" content="企业级测试基线，适用于单元测试、集成测试、接口测试、性能测试场景"><meta data-rh="true" property="og:description" content="企业级测试基线，适用于单元测试、集成测试、接口测试、性能测试场景"><link data-rh="true" rel="icon" href="/docs-engine/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://w3bank.github.io/docs-engine/docs/L0-enterprise/standards/testing-standards"><link data-rh="true" rel="alternate" href="https://w3bank.github.io/docs-engine/docs/L0-enterprise/standards/testing-standards" hreflang="en"><link data-rh="true" rel="alternate" href="https://w3bank.github.io/docs-engine/docs/L0-enterprise/standards/testing-standards" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Enterprise Knowledge Standards (L0)","item":"https://w3bank.github.io/docs-engine/docs/L0-enterprise/"},{"@type":"ListItem","position":2,"name":"测试规范","item":"https://w3bank.github.io/docs-engine/docs/L0-enterprise/standards/testing-standards"}]}</script><link rel="alternate" type="application/rss+xml" href="/docs-engine/blog/rss.xml" title="W3Bank Knowledge Wiki RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/docs-engine/blog/atom.xml" title="W3Bank Knowledge Wiki Atom Feed"><link rel="stylesheet" href="/docs-engine/assets/css/styles.9c53a5ce.css">
<script src="/docs-engine/assets/js/runtime~main.d6abfd9c.js" defer="defer"></script>
<script src="/docs-engine/assets/js/main.11d14142.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/docs-engine/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs-engine/"><div class="navbar__logo"><img src="/docs-engine/img/logo.svg" alt="W3Bank Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/docs-engine/img/logo.svg" alt="W3Bank Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">W3Bank Wiki</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs-engine/docs/L0-enterprise/">Tutorial</a><a class="navbar__item navbar__link" href="/docs-engine/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/w3bank/w3bank.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/docs-engine/docs/L0-enterprise/"><span title="Enterprise Knowledge Standards (L0)" class="categoryLinkLabel_W154">Enterprise Knowledge Standards (L0)</span></a><button aria-label="Collapse sidebar category &#x27;Enterprise Knowledge Standards (L0)&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs-engine/docs/L0-enterprise/ai-coding/ai-coding-policy"><span title="ai-coding" class="categoryLinkLabel_W154">ai-coding</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs-engine/docs/L0-enterprise/constitution/architecture-principles"><span title="constitution" class="categoryLinkLabel_W154">constitution</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs-engine/docs/L0-enterprise/governance/release-process"><span title="governance" class="categoryLinkLabel_W154">governance</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs-engine/docs/L0-enterprise/standards/api-design-guide"><span title="standards" class="categoryLinkLabel_W154">standards</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs-engine/docs/L0-enterprise/standards/api-design-guide"><span title="API 设计规范" class="linkLabel_WmDU">API 设计规范</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs-engine/docs/L0-enterprise/standards/coding-standards/java"><span title="coding-standards" class="categoryLinkLabel_W154">coding-standards</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs-engine/docs/L0-enterprise/standards/python/django-pro-cn"><span title="python" class="categoryLinkLabel_W154">python</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs-engine/docs/L0-enterprise/standards/testing-standards"><span title="测试规范" class="linkLabel_WmDU">测试规范</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs-engine/docs/L0-enterprise/technology-radar/adopt"><span title="technology-radar" class="categoryLinkLabel_W154">technology-radar</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs-engine/docs/L0-enterprise/test"><span title="Hello World" class="linkLabel_WmDU">Hello World</span></a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs-engine/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs-engine/docs/L0-enterprise/"><span>Enterprise Knowledge Standards (L0)</span></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">standards</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">测试规范</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>测试规范</h1></header>
<blockquote>
<p>企业级测试基线，适用于单元测试、集成测试、接口测试、性能测试场景</p>
</blockquote>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="一测试分层规范-must">一、测试分层规范 [MUST]<a href="#一测试分层规范-must" class="hash-link" aria-label="Direct link to 一、测试分层规范 [MUST]" title="Direct link to 一、测试分层规范 [MUST]" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="11-测试层级">1.1 测试层级<a href="#11-测试层级" class="hash-link" aria-label="Direct link to 1.1 测试层级" title="Direct link to 1.1 测试层级" translate="no">​</a></h3>
<table><thead><tr><th>层级</th><th>核心目标</th><th>覆盖范围</th><th>工具选型</th></tr></thead><tbody><tr><td>单元测试</td><td>验证单个类/方法逻辑</td><td>Service 核心逻辑 ≥80%</td><td>JUnit5 + Mockito</td></tr><tr><td>集成测试</td><td>验证依赖协作</td><td>DB + Redis + 跨服务</td><td>JUnit5 + Testcontainers</td></tr><tr><td>契约测试</td><td>验证服务间接口契约</td><td>所有对外 API</td><td>Spring Cloud Contract</td></tr><tr><td>接口测试</td><td>验证 HTTP 接口</td><td>所有对外接口 100%</td><td>RestAssured</td></tr><tr><td>性能测试</td><td>验证高并发稳定性</td><td>核心接口</td><td>JMeter / Gatling</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="12-覆盖率要求">1.2 覆盖率要求<a href="#12-覆盖率要求" class="hash-link" aria-label="Direct link to 1.2 覆盖率要求" title="Direct link to 1.2 覆盖率要求" translate="no">​</a></h3>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">coverage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">service_layer</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 80%   </span><span class="token comment" style="color:#999988;font-style:italic"># Service 层核心逻辑</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">dao_layer</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 50%       </span><span class="token comment" style="color:#999988;font-style:italic"># Dao 层</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">controller_layer</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 60%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">overall</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 70%</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="二单元测试规范-must">二、单元测试规范 [MUST]<a href="#二单元测试规范-must" class="hash-link" aria-label="Direct link to 二、单元测试规范 [MUST]" title="Direct link to 二、单元测试规范 [MUST]" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="21-核心原则">2.1 核心原则<a href="#21-核心原则" class="hash-link" aria-label="Direct link to 2.1 核心原则" title="Direct link to 2.1 核心原则" translate="no">​</a></h3>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">principles</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 隔离外部依赖（DB、Redis、HTTP）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 覆盖正常 + 异常 + 边界场景</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 可重复执行</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 命名规范：方法名_场景_预期结果</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="22-mock-规范">2.2 Mock 规范<a href="#22-mock-规范" class="hash-link" aria-label="Direct link to 2.2 Mock 规范" title="Direct link to 2.2 Mock 规范" translate="no">​</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@SpringBootTest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class OrderServiceTest {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private OrderService orderService;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @MockBean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private OrderMapper orderMapper;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @MockBean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private UserFeignApi userFeignApi;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @MockBean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private RedisTemplate&lt;String, String&gt; redisTemplate;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ✅ 正确：测试正常场景</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void createOrder_ValidParams_ReturnOrderId() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Arrange - 准备 Mock 数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        when(userFeignApi.getUserById(1001L)).thenReturn(Result.success(mockUser));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        when(redisTemplate.opsForValue().get(&quot;stock:2001&quot;)).thenReturn(&quot;10&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        when(orderMapper.insert(any(Order.class))).thenReturn(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Act - 执行测试方法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Long orderId = orderService.createOrder(validRequest);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Assert - 断言结果</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assertNotNull(orderId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        verify(orderMapper, times(1)).insert(any(Order.class));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ✅ 正确：测试异常场景</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void createOrder_UserNotFound_ThrowServiceException() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        when(userFeignApi.getUserById(1001L)).thenReturn(Result.success(null));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ServiceException exception = assertThrows(ServiceException.class, () -&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            orderService.createOrder(validRequest);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assertEquals(&quot;用户不存在&quot;, exception.getMessage());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        verifyNoInteractions(orderMapper);  // 验证 Mapper 未被调用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ✅ 正确：测试边界场景</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void createOrder_StockZero_ThrowServiceException() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        when(userFeignApi.getUserById(1001L)).thenReturn(Result.success(mockUser));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        when(redisTemplate.opsForValue().get(&quot;stock:2001&quot;)).thenReturn(&quot;0&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assertThrows(ServiceException.class, () -&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            orderService.createOrder(validRequest);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="23-禁止项">2.3 禁止项<a href="#23-禁止项" class="hash-link" aria-label="Direct link to 2.3 禁止项" title="Direct link to 2.3 禁止项" translate="no">​</a></h3>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">prohibited</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 单元测试依赖真实 DB/Redis</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 测试用例之间有依赖</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 只测试正常场景</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 吞异常不断言</span><br></span></code></pre></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// ❌ 错误：依赖真实数据库</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">void testCreateOrder() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Order order = orderMapper.selectById(1L);  // 依赖真实 DB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    assertNotNull(order);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ❌ 错误：只断言不抛异常</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">void testCreateOrder() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        orderService.createOrder(null);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 吞异常，测试永远通过</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="三测试幂等性规范-must">三、测试幂等性规范 [MUST]<a href="#三测试幂等性规范-must" class="hash-link" aria-label="Direct link to 三、测试幂等性规范 [MUST]" title="Direct link to 三、测试幂等性规范 [MUST]" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="31-核心原则">3.1 核心原则<a href="#31-核心原则" class="hash-link" aria-label="Direct link to 3.1 核心原则" title="Direct link to 3.1 核心原则" translate="no">​</a></h3>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">idempotency_rules</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 每个测试用例必须独立执行</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 测试执行顺序不影响结果</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 重复执行测试必须得到相同结果</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="32-数据管理">3.2 数据管理<a href="#32-数据管理" class="hash-link" aria-label="Direct link to 3.2 数据管理" title="Direct link to 3.2 数据管理" translate="no">​</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@SpringBootTest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class OrderServiceTest {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @BeforeEach</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void setUp() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        orderMapper.delete(new QueryWrapper&lt;&gt;());  // 清理数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 插入测试基础数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @AfterEach</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void tearDown() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        orderMapper.delete(new QueryWrapper&lt;&gt;());  // 清理数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="33-禁止项">3.3 禁止项<a href="#33-禁止项" class="hash-link" aria-label="Direct link to 3.3 禁止项" title="Direct link to 3.3 禁止项" translate="no">​</a></h3>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">prohibited</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 使用固定 ID 作为测试数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 依赖测试执行顺序</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 不清理测试产生的数据</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="四集成测试规范-must">四、集成测试规范 [MUST]<a href="#四集成测试规范-must" class="hash-link" aria-label="Direct link to 四、集成测试规范 [MUST]" title="Direct link to 四、集成测试规范 [MUST]" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="41-testcontainers-使用">4.1 Testcontainers 使用<a href="#41-testcontainers-使用" class="hash-link" aria-label="Direct link to 4.1 Testcontainers 使用" title="Direct link to 4.1 Testcontainers 使用" translate="no">​</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@SpringBootTest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Testcontainers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class OrderServiceIntegrationTest {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Container</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    static MySQLContainer&lt;?&gt; mysqlContainer = new MySQLContainer&lt;&gt;(&quot;mysql:8.0&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .withDatabaseName(&quot;test_order_db&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .withUsername(&quot;test&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .withPassword(&quot;test123&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Container</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    static GenericContainer&lt;?&gt; redisContainer = new GenericContainer&lt;&gt;(&quot;redis:6.2&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .withExposedPorts(6379);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @DynamicPropertySource</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    static void registerProperties(DynamicPropertyRegistry registry) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        registry.add(&quot;spring.datasource.url&quot;, mysqlContainer::getJdbcUrl);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        registry.add(&quot;spring.datasource.username&quot;, mysqlContainer::getUsername);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        registry.add(&quot;spring.datasource.password&quot;, mysqlContainer::getPassword);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        registry.add(&quot;spring.redis.host&quot;, redisContainer::getHost);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        registry.add(&quot;spring.redis.port&quot;, redisContainer::getFirstMappedPort);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @BeforeEach</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void setUp() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 初始化测试数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ScriptUtils.executeSqlScript(dataSource.getConnection(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            new ClassPathResource(&quot;sql/schema.sql&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        redisTemplate.opsForValue().set(&quot;stock:2001&quot;, &quot;10&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @AfterEach</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void tearDown() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 清理测试数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        orderMapper.delete(new QueryWrapper&lt;&gt;());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        redisTemplate.delete(&quot;stock:2001&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void testCreateOrder_RealDependencies_Success() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Long orderId = orderService.createOrder(validRequest);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assertNotNull(orderId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 验证数据库</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Order order = orderMapper.selectById(orderId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assertEquals(1001L, order.getUserId());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 验证 Redis</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assertEquals(&quot;8&quot;, redisTemplate.opsForValue().get(&quot;stock:2001&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="32-数据隔离">3.2 数据隔离<a href="#32-数据隔离" class="hash-link" aria-label="Direct link to 3.2 数据隔离" title="Direct link to 3.2 数据隔离" translate="no">​</a></h3>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">rules</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 每个测试用例数据独立</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> @BeforeEach 初始化数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> @AfterEach 清理数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 禁止测试间共享数据</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="五接口测试规范-must">五、接口测试规范 [MUST]<a href="#五接口测试规范-must" class="hash-link" aria-label="Direct link to 五、接口测试规范 [MUST]" title="Direct link to 五、接口测试规范 [MUST]" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="51-restassured-测试">5.1 RestAssured 测试<a href="#51-restassured-测试" class="hash-link" aria-label="Direct link to 5.1 RestAssured 测试" title="Direct link to 5.1 RestAssured 测试" translate="no">​</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class OrderControllerTest {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @LocalServerPort</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private int port;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @BeforeEach</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void setUp() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RestAssured.baseURI = &quot;http://localhost&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RestAssured.port = port;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ✅ 正确：测试正常场景</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void testCreateOrder_Success() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        given()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .contentType(ContentType.JSON)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .body(&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;userId&quot;: 1001,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;goodsList&quot;: [{&quot;goodsId&quot;: 2001, &quot;quantity&quot;: 2}],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;amount&quot;: 200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;&quot;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .when()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .post(&quot;/api/v1/orders&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .then()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .statusCode(200)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .body(&quot;code&quot;, equalTo(200))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .body(&quot;data&quot;, notNullValue());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ✅ 正确：测试权限场景</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void testUpdateOrder_UnLogin_Fail() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        given()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .contentType(ContentType.JSON)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .body(&quot;{\&quot;orderId\&quot;: 3001, \&quot;status\&quot;: 2}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .when()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .post(&quot;/api/v1/orders/status&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .then()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .statusCode(200)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .body(&quot;code&quot;, equalTo(401))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .body(&quot;msg&quot;, equalTo(&quot;未登录&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ✅ 正确：测试幂等性</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void testCreateOrder_DuplicateRequest_Idempotent() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String requestId = &quot;test-123456&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (int i = 0; i &lt; 2; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            given()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .contentType(ContentType.JSON)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .header(&quot;X-Request-Id&quot;, requestId)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .body(validRequestJson)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .when()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .post(&quot;/api/v1/orders&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .then()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .statusCode(200)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .body(&quot;data&quot;, equalTo(3001));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        verify(orderService, times(1)).createOrder(any());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ✅ 正确：测试 SQL 注入防护</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void testQueryOrder_SqlInjection_Fail() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        given()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .pathParam(&quot;orderId&quot;, &quot;3001&#x27; OR &#x27;1&#x27;=&#x27;1&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .when()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .get(&quot;/api/v1/orders/{orderId}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .then()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .statusCode(400)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .body(&quot;msg&quot;, containsString(&quot;非法参数&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="42-覆盖场景">4.2 覆盖场景<a href="#42-覆盖场景" class="hash-link" aria-label="Direct link to 4.2 覆盖场景" title="Direct link to 4.2 覆盖场景" translate="no">​</a></h3>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">scenarios</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 正常请求</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 参数校验失败</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 权限校验失败</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 业务异常</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 幂等性</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> SQL 注入防护</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> XSS 防护</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="六性能测试规范-should">六、性能测试规范 [SHOULD]<a href="#六性能测试规范-should" class="hash-link" aria-label="Direct link to 六、性能测试规范 [SHOULD]" title="Direct link to 六、性能测试规范 [SHOULD]" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="61-测试指标">6.1 测试指标<a href="#61-测试指标" class="hash-link" aria-label="Direct link to 6.1 测试指标" title="Direct link to 6.1 测试指标" translate="no">​</a></h3>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">metrics</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">qps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 目标 QPS（如 2000）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">rt_p99</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> P99 响应时间（如 200ms）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">rt_p95</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> P95 响应时间（如 100ms）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">error_rate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 错误率（&lt;0.1%）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">cpu</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> &lt;80%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">memory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> &lt;85%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">gc_pause</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> &lt;100ms</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="52-测试环境">5.2 测试环境<a href="#52-测试环境" class="hash-link" aria-label="Direct link to 5.2 测试环境" title="Direct link to 5.2 测试环境" translate="no">​</a></h3>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">rules</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 预发环境执行（与生产配置一致）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 清理历史数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 监控 JVM 指标</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 持续压测 30 分钟</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="53-jmeter-配置">5.3 JMeter 配置<a href="#53-jmeter-配置" class="hash-link" aria-label="Direct link to 5.3 JMeter 配置" title="Direct link to 5.3 JMeter 配置" translate="no">​</a></h3>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">thread_group</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">threads</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">ramp_up</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">60</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic"># 60 秒启动所有线程</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">duration</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1800</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic"># 持续 30 分钟</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">http_request</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">method</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> POST</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /api/v1/orders</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">content_type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> application/json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">body</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">      &quot;userId&quot;: ${userId},</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">      &quot;goodsList&quot;: [{&quot;goodsId&quot;: 2001, &quot;quantity&quot;: 1}],</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">      &quot;amount&quot;: 100</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">    }</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="七cicd-集成规范-must">七、CI/CD 集成规范 [MUST]<a href="#七cicd-集成规范-must" class="hash-link" aria-label="Direct link to 七、CI/CD 集成规范 [MUST]" title="Direct link to 七、CI/CD 集成规范 [MUST]" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="71-流水线配置">7.1 流水线配置<a href="#71-流水线配置" class="hash-link" aria-label="Direct link to 7.1 流水线配置" title="Direct link to 7.1 流水线配置" translate="no">​</a></h3>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Test Pipeline</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">push</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">branches</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">main</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> develop</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">pull_request</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">branches</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">main</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> develop</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">jobs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">unit-test</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">runs-on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> actions/checkout@v4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Set up JDK 17</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> actions/setup</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">java@v4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">with</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">java-version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;17&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">distribution</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;temurin&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">cache</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> maven</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Run Unit Tests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> mvn test </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">Dtest=</span><span class="token important">*ServiceTest</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Generate Coverage Report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> mvn jacoco</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Check Coverage Threshold</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          COVERAGE=$(grep -oP &#x27;Total.*?([0-9]+)%&#x27; target/site/jacoco/index.html | grep -oP &#x27;[0-9]+&#x27; | head -1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          if [ &quot;$COVERAGE&quot; -lt 80 ]; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            echo &quot;Coverage $COVERAGE% is below 80% threshold&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            exit 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Upload Coverage Report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> actions/upload</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">artifact@v4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">with</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> jacoco</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> target/site/jacoco/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">integration-test</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">runs-on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">needs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> unit</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">services</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">mysql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> mysql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">8.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">env</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">MYSQL_ROOT_PASSWORD</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> test123</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">MYSQL_DATABASE</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> test_db</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 3306</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">3306</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">redis</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> redis</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">6.2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 6379</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">6379</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> actions/checkout@v4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Run Integration Tests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> mvn test </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">Dtest=</span><span class="token important">*IntegrationTest</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">env</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">SPRING_DATASOURCE_URL</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> jdbc</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">mysql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//localhost</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">3306/test_db</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">SPRING_REDIS_HOST</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> localhost</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">api-test</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">runs-on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">needs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> integration</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Run API Tests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> mvn test </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">Dtest=</span><span class="token important">*ControllerTest</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="62-质量门禁">6.2 质量门禁<a href="#62-质量门禁" class="hash-link" aria-label="Direct link to 6.2 质量门禁" title="Direct link to 6.2 质量门禁" translate="no">​</a></h3>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">quality_gates</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> unit_test_coverage </span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain">= 80%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> all_tests_passed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> no_critical_issues (SonarQube)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> no_high_vulnerabilities</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="八反模式检查清单">八、反模式检查清单<a href="#八反模式检查清单" class="hash-link" aria-label="Direct link to 八、反模式检查清单" title="Direct link to 八、反模式检查清单" translate="no">​</a></h2>
<table><thead><tr><th>序号</th><th>反模式</th><th>检测方式</th></tr></thead><tbody><tr><td>1</td><td>单元测试依赖真实 DB</td><td>检查是否使用 @MockBean</td></tr><tr><td>2</td><td>只覆盖正常场景</td><td>检查异常场景测试用例</td></tr><tr><td>3</td><td>接口测试仅验证 code=200</td><td>检查响应体断言</td></tr><tr><td>4</td><td>性能测试在开发环境执行</td><td>检查测试环境配置</td></tr><tr><td>5</td><td>契约测试缺失</td><td>检查服务间接口定义</td></tr><tr><td>6</td><td>测试数据未隔离</td><td>检查 @BeforeEach/@AfterEach</td></tr><tr><td>7</td><td>覆盖率低于 80%</td><td>JaCoCo 报告检查</td></tr><tr><td>8</td><td>未集成 CI/CD</td><td>检查流水线配置</td></tr><tr><td>9</td><td>测试用例未随代码更新</td><td>检查测试代码提交记录</td></tr><tr><td>10</td><td>吞异常不断言</td><td>检查 catch 块处理</td></tr><tr><td>11</td><td>使用固定 ID 测试数据</td><td>检查测试数据生成方式</td></tr><tr><td>12</td><td>依赖测试执行顺序</td><td>检查 @Order 注解使用</td></tr></tbody></table></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/L0-enterprise/standards/testing-standards.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs-engine/docs/L0-enterprise/standards/python/python-scaffold"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Python Project Scaffolding</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs-engine/docs/L0-enterprise/technology-radar/adopt"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">技术雷达 - 采用（Adopt）</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#一测试分层规范-must" class="table-of-contents__link toc-highlight">一、测试分层规范 [MUST]</a><ul><li><a href="#11-测试层级" class="table-of-contents__link toc-highlight">1.1 测试层级</a></li><li><a href="#12-覆盖率要求" class="table-of-contents__link toc-highlight">1.2 覆盖率要求</a></li></ul></li><li><a href="#二单元测试规范-must" class="table-of-contents__link toc-highlight">二、单元测试规范 [MUST]</a><ul><li><a href="#21-核心原则" class="table-of-contents__link toc-highlight">2.1 核心原则</a></li><li><a href="#22-mock-规范" class="table-of-contents__link toc-highlight">2.2 Mock 规范</a></li><li><a href="#23-禁止项" class="table-of-contents__link toc-highlight">2.3 禁止项</a></li></ul></li><li><a href="#三测试幂等性规范-must" class="table-of-contents__link toc-highlight">三、测试幂等性规范 [MUST]</a><ul><li><a href="#31-核心原则" class="table-of-contents__link toc-highlight">3.1 核心原则</a></li><li><a href="#32-数据管理" class="table-of-contents__link toc-highlight">3.2 数据管理</a></li><li><a href="#33-禁止项" class="table-of-contents__link toc-highlight">3.3 禁止项</a></li></ul></li><li><a href="#四集成测试规范-must" class="table-of-contents__link toc-highlight">四、集成测试规范 [MUST]</a><ul><li><a href="#41-testcontainers-使用" class="table-of-contents__link toc-highlight">4.1 Testcontainers 使用</a></li><li><a href="#32-数据隔离" class="table-of-contents__link toc-highlight">3.2 数据隔离</a></li></ul></li><li><a href="#五接口测试规范-must" class="table-of-contents__link toc-highlight">五、接口测试规范 [MUST]</a><ul><li><a href="#51-restassured-测试" class="table-of-contents__link toc-highlight">5.1 RestAssured 测试</a></li><li><a href="#42-覆盖场景" class="table-of-contents__link toc-highlight">4.2 覆盖场景</a></li></ul></li><li><a href="#六性能测试规范-should" class="table-of-contents__link toc-highlight">六、性能测试规范 [SHOULD]</a><ul><li><a href="#61-测试指标" class="table-of-contents__link toc-highlight">6.1 测试指标</a></li><li><a href="#52-测试环境" class="table-of-contents__link toc-highlight">5.2 测试环境</a></li><li><a href="#53-jmeter-配置" class="table-of-contents__link toc-highlight">5.3 JMeter 配置</a></li></ul></li><li><a href="#七cicd-集成规范-must" class="table-of-contents__link toc-highlight">七、CI/CD 集成规范 [MUST]</a><ul><li><a href="#71-流水线配置" class="table-of-contents__link toc-highlight">7.1 流水线配置</a></li><li><a href="#62-质量门禁" class="table-of-contents__link toc-highlight">6.2 质量门禁</a></li></ul></li><li><a href="#八反模式检查清单" class="table-of-contents__link toc-highlight">八、反模式检查清单</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs-engine/docs/L0-enterprise/">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs-engine/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 W3Bank. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>